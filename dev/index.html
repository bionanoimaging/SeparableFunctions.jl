<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SeparableFunctions.jl · SeparableFunctions.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">SeparableFunctions.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>SeparableFunctions.jl</a><ul class="internal"><li><a class="tocitem" href="#SeparableFunctions.jl-Interface"><span>SeparableFunctions.jl Interface</span></a></li><li><a class="tocitem" href="#Generic-Ways-to-Create-Seperable-and-Radial-Functions"><span>Generic Ways to Create Seperable and Radial Functions</span></a></li></ul></li><li><a class="tocitem" href="separables/">Concrete Separable Functions</a></li><li><a class="tocitem" href="radial/">Radial Functions</a></li><li><a class="tocitem" href="utilities/">Utilities</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SeparableFunctions.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SeparableFunctions.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bionanoimaging/SeparableFunctions.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SeparableFunctions.jl"><a class="docs-heading-anchor" href="#SeparableFunctions.jl">SeparableFunctions.jl</a><a id="SeparableFunctions.jl-1"></a><a class="docs-heading-anchor-permalink" href="#SeparableFunctions.jl" title="Permalink"></a></h1><h2 id="SeparableFunctions.jl-Interface"><a class="docs-heading-anchor" href="#SeparableFunctions.jl-Interface">SeparableFunctions.jl Interface</a><a id="SeparableFunctions.jl-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#SeparableFunctions.jl-Interface" title="Permalink"></a></h2><p>General information</p><article class="docstring"><header><a class="docstring-binding" id="SeparableFunctions" href="#SeparableFunctions"><code>SeparableFunctions</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Calculates multidimensional functions faster by exploiting their separability. Often a function involves an operation such as a (complex) exponential which by itself is computationally relatively heavy. Yet a number of multidimenstional functions are separable, which means that they can be written as a product (or sum) of single-dimensional functions. A good example of a separable function is a Gaussian function, which can be written as a product of a purely X-dependend Gaussian with a purely Y-dependend Gaussian.</p><p>In this package, multidimensional functions are computed by first calculating their single-dimensional values and then creating the final multidimensional result by an outer product. Since multiplications and the broadcasting mechanism of Julia are fast compared to the evaluation of the function at each multidimensional position, the final result is calculated faster. The typical speedup can be an order of magnitude.</p><p>The package offers a general way of calculating separable functions as well as a <code>LazyArrays</code> version of that function which can then be used inside other expressions. The non-lazy version should currently also work with <code>CUDA.jl</code>, however the <code>LazyArrays</code> version does not. To nevertheless use separable expressions in <code>CUDA.jl</code>, you can reside to externally applying the broadcast operator to the separable expression (see the <code>gaussian_sep</code> example below).</p><p>The package further offers a number of predifined separable function implementations such as <code>gaussian_col()</code> collects a multidimensional array of a multidimensional Gaussian via a fast seperable implementation, <code>gaussian_lz()</code> yields a lazy representation via <code>LazyArrays</code> and <code>sep = gaussian_sep()</code> yields an iterable of separable pre-oriented vectors which can easily be mutually combined via <code>.*(sep...)</code>.</p><p>Another noteworthy example is the complex plain wave as represented by the respective function <code>exp_ikx_col()</code>, <code>exp_ikx_lz()</code>, <code>exp_ikx_sep()</code>.</p><p>All separable functions share a common interface with Standard non-named arguments</p><ul><li>the first optional argument being the type of the result array. Examples are <code>Array{Float64}</code>, <code>CuArray{Float32}</code> and the default depends on the function but uses a 32-bit result type where applicable.</li><li>the next argument is the <code>size</code> of the result data supplied as a tuple.</li><li>optionally a further argument can specify the <code>position</code> of zero of the array with respect to <code>offset</code> as given below. This allows for convenient N-dimensional shifting of the functions. </li></ul><p>Named arguments:</p><ul><li><code>offset</code>: is a optional named argument specifying center of the array. By default the Fourier center, <code>size().÷2 .+ 1</code> is chosen.</li><li><code>scale</code>: multiplies the axes with these factors. This can be interpreted as a <code>pixelsize</code>.</li></ul><p>Some functions have additional named arguments. E.g. <code>gaussian</code> has the additional named argument <code>sigma</code> specifying the width of the gaussian, even though this can also be controlled via <code>scale</code>.  Note that this nomenclature is in large parts identical to the package <code>IndexFunArrays.jl</code>.</p><p>In general arguments can be supplied as single scalar values or vectors. If a scalar value is supplied, it will automatically be replicated as a vector. E.g. <code>sigma=10.0</code> for a  2-dimensional array will be interpreted as <code>sigma=(10.0, 10.0)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bionanoimaging/SeparableFunctions.jl/blob/cf221bf4be81aa52510e31c657e86691895ecd9b/src/SeparableFunctions.jl#L1-L26">source</a></section></article><h2 id="Generic-Ways-to-Create-Seperable-and-Radial-Functions"><a class="docs-heading-anchor" href="#Generic-Ways-to-Create-Seperable-and-Radial-Functions">Generic Ways to Create Seperable and Radial Functions</a><a id="Generic-Ways-to-Create-Seperable-and-Radial-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Generic-Ways-to-Create-Seperable-and-Radial-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SeparableFunctions.calculate_separables" href="#SeparableFunctions.calculate_separables"><code>SeparableFunctions.calculate_separables</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">calculate_separables([::Type{AT},] fct, sz::NTuple{N, Int}, args...; dims = 1:N, pos=zero(real(eltype(AT))), offset=sz.÷2 .+1, scale=one(real(eltype(AT))), kwargs...) where {AT, N}</code></pre><p>creates a list of one-dimensional vectors, which can be combined to yield a separable array. In a way this can be seen as a half-way Lazy operation. The (potentially heavy) work of calculating the one-dimensional functions is done now but the memory-heavy calculation of the array is done later. This function is used in <code>separable_view</code> and <code>separable_create</code>.</p><p>#Arguments</p><ul><li><code>AT</code>:     optional type signfying the array result type. You can for example use <code>CuArray{Float32}</code> using <code>CUDA</code> to create the views on the GPU.</li><li><code>fct</code>:    the function to calculate for each axis index (no need for broadcasting!) of this iterable of seperable axes. Note that the first arguments of <code>fct</code> have to be the index of this coordinate and the size of this axis. Any further <code>args</code> and <code>nargs</code> can follow. Often the second argument is not used but it still needs to be present.</li><li><code>sz</code>:     the size of the result array (when appying the one-D axes)</li><li><code>args</code>:   further arguments which are passed over to the function <code>fct</code>.</li><li><code>dims</code>:   a vector <code>[]</code> of valid dimensions. Only these dimension will be calculated but they are oriented in ND.</li><li><code>pos</code>:    a position shifting the indices passed to <code>fct</code> in relationship to the <code>offset</code>.</li><li><code>offset</code>: specifying the center (zero-position) of the result array in one-based coordinates. The default corresponds to the Fourier-center.</li><li><code>scale</code>:  multiplies the index before passing it to <code>fct</code></li></ul><p>#Example:</p><pre><code class="language-julia">julia&gt; fct = (r, sz, sigma)-&gt; exp(-r^2/(2*sigma^2))
julia&gt; gauss_sep = calculate_separables(fct, (6,5), (0.5,1.0), pos = (0.1,0.2))
2-element Vector{Array{Float32}}:
 [4.4963495f-9; 0.00014774836; … ; 0.1978987; 0.0007318024;;]
 [0.088921614 0.48675224 … 0.726149 0.1978987]
 julia&gt; my_gaussian = .*(gauss_sep...) # this is how to broadcast it
 6×5 Matrix{Float32}:
 3.99823f-10  2.18861f-9   4.40732f-9   3.26502f-9   8.89822f-10
 1.3138f-5    7.19168f-5   0.000144823  0.000107287  2.92392f-5
 0.00790705   0.0432828    0.0871608    0.0645703    0.0175975
 0.0871608    0.477114     0.960789     0.71177      0.19398
 0.0175975    0.0963276    0.19398      0.143704     0.0391639
 6.50731f-5   0.000356206  0.000717312  0.000531398  0.000144823</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bionanoimaging/SeparableFunctions.jl/blob/cf221bf4be81aa52510e31c657e86691895ecd9b/src/general.jl#L1-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SeparableFunctions.separable_view" href="#SeparableFunctions.separable_view"><code>SeparableFunctions.separable_view</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">separable_view{N}(fct, sz, args...; pos=zero(real(eltype(AT))), offset =  sz.÷2 .+1, scale = one(real(eltype(AT))), operation = .*)</code></pre><p>creates an array view of an N-dimensional separable function. Note that this view consumes much less memory than a full allocation of the collected result. Note also that an N-dimensional calculation expression may be much slower than this view reprentation of a product of N one-dimensional arrays. See the example below.</p><p><strong>Arguments:</strong></p><ul><li><code>fct</code>:          The separable function, with a number of arguments corresponding to <code>length(args)</code>, each corresponding to a vector of separable inputs of length N.                 The first argument of this function is a Tuple corresponding the centered indices.</li><li><code>sz</code>:           The size of the N-dimensional array to create</li><li><code>args</code>...:      a list of arguments, each being an N-dimensional vector</li><li><code>dims</code>:         a vector <code>[]</code> of valid dimensions. Only these dimension will be calculated but they are oriented in ND.</li><li><code>offset</code>:       position of the center from which the position is measured</li><li><code>scale</code>:        defines the pixel size as vector or scalar. Default: 1.0.</li><li><code>operation</code>:    the separable operation connecting the separable dimensions</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia">julia&gt; fct = (r, sz, pos, sigma)-&gt; exp(-(r-pos)^2/(2*sigma^2))
julia&gt; my_gaussian = separable_view(fct, (6,5), (0.1,0.2), (0.5,1.0))
(6×1 Matrix{Float32}) .* (1×5 Matrix{Float32}):
 3.99823e-10  2.18861e-9   4.40732e-9   3.26502e-9   8.89822e-10
 1.3138e-5    7.19168e-5   0.000144823  0.000107287  2.92392e-5
 0.00790705   0.0432828    0.0871609    0.0645703    0.0175975
 0.0871609    0.477114     0.960789     0.71177      0.19398
 0.0175975    0.0963276    0.19398      0.143704     0.0391639
 6.50731e-5   0.000356206  0.000717312  0.000531398  0.000144823</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bionanoimaging/SeparableFunctions.jl/blob/cf221bf4be81aa52510e31c657e86691895ecd9b/src/general.jl#L66-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SeparableFunctions.separable_create" href="#SeparableFunctions.separable_create"><code>SeparableFunctions.separable_create</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">separable_create([::Type{TA},] fct, sz::NTuple{N, Int}, args...; pos=zero(real(eltype(AT))), offset =  sz.÷2 .+1, scale = one(real(eltype(AT))), operation = *, kwargs...) where {TA, N}</code></pre><p>creates an array view of an N-dimensional separable function including memory allocation and collection. See the example below.</p><p><strong>Arguments:</strong></p><ul><li><code>fct</code>:          The separable function, with a number of arguments corresponding to <code>length(args)</code>, each corresponding to a vector of separable inputs of length N.                 The first argument of this function is a Tuple corresponding the centered indices.</li><li><code>sz</code>:           The size of the N-dimensional array to create</li><li><code>args</code>...:      a list of arguments, each being an N-dimensional vector</li><li><code>dims</code>:         a vector <code>[]</code> of valid dimensions. Only these dimension will be calculated but they are oriented in ND.</li><li><code>offset</code>:       position of the center from which the position is measured</li><li><code>scale</code>:        defines the pixel size as vector or scalar. Default: 1.0.</li><li><code>operation</code>:    the separable operation connecting the separable dimensions</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia">julia&gt; fct = (r, sz, sigma)-&gt; exp(-r^2/(2*sigma^2))
julia&gt; my_gaussian = separable_create(fct, (6,5), (0.5,1.0); pos=(0.1,0.2))
6×5 Matrix{Float32}:
 3.99823f-10  2.18861f-9   4.40732f-9   3.26502f-9   8.89822f-10
 1.3138f-5    7.19168f-5   0.000144823  0.000107287  2.92392f-5
 0.00790705   0.0432828    0.0871608    0.0645703    0.0175975
 0.0871608    0.477114     0.960789     0.71177      0.19398
 0.0175975    0.0963276    0.19398      0.143704     0.0391639
 6.50731f-5   0.000356206  0.000717312  0.000531398  0.000144823</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bionanoimaging/SeparableFunctions.jl/blob/cf221bf4be81aa52510e31c657e86691895ecd9b/src/general.jl#L106-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SeparableFunctions.copy_corners!" href="#SeparableFunctions.copy_corners!"><code>SeparableFunctions.copy_corners!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">copy_corners!(arr::AbstractArray{T,N}) where {T,N}</code></pre><p>replicates the first N-dimensional quadrant my several mirror operations over the entire array. The overwrites the entire array with the (mirrored) content of the first quadrant!</p><p>#Arguments</p><ul><li><code>arr</code>:    The array in which the copy operations are performed</li><li><code>speedup_last_dim=true</code>:  if <code>true</code> a one-dimensional assignment trick is used for the last non-singleton dimension.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bionanoimaging/SeparableFunctions.jl/blob/cf221bf4be81aa52510e31c657e86691895ecd9b/src/radial.jl#L19-L28">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="separables/">Concrete Separable Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 31 January 2023 22:29">Tuesday 31 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
